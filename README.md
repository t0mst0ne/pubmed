# 套件說明：
* biopython: 與 Entrez (PubMed) API 互動。
* gspread: 與 Google 試算表互動。
* gspread-dataframe: 處理 DataFrames 和 Google 試算表。
* google-api-python-client: 與 Google APIs 互動（此處特別指 Drive API）。
* google-auth-httplib2: 驗證 Google APIs。
* google-auth-oauthlib: 處理 OAuth 流程（如果您使用的是基於用戶的驗證而不是服務帳戶）。
* openai: 使用 OpenAI API（用於生成搜尋詞組和翻譯）。
* pandas: 數據操作（處理 DataFrames）。
* python-dotenv: 從 .env 文件載入環境變數（建議用於在本地儲存 API 金鑰）。
* tqdm: 添加進度條。
* PyYAML: 從 YAML 文件讀取配置（如果您選擇使用 YAML 而不是純文字文件或 .env 儲存 API 金鑰）。

## 如何使用 requirements.txt：
* 儲存： 將以上內容儲存為項目根目錄中名為 requirements.txt 的文件。
* 安裝： 用戶可以在項目的根目錄中，於終端機執行以下指令來安裝所需的套件：
* Bash pip install -r requirements.txt

# Google 試算表分享 - 步驟教學：
以下步驟將指導用戶如何與您的服務帳戶分享 Google 試算表，以便Script 可以直接訪問和修改它。

## Google Cloud 設定步驟教學：
### 建立 Google Cloud 專案 以取得 "服務帳戶金鑰" 和 "服務帳戶電子郵件"：

* 前往 Google Cloud Console：打開網頁瀏覽器並前往 https://console.cloud.google.com/ 。
* 登入：如果您尚未登入，請使用您的 Google 帳戶登入。
* 選擇或建立專案：
* 如果您有想要使用的現有專案，請點擊頂部欄位中的專案選擇下拉式選單（Google Cloud 標誌旁邊），然後選擇您的專案。
* 如果您需要建立新的專案，請點擊專案選擇下拉式選單，然後點擊「新增專案」。
* 為您的專案提供一個描述性名稱（例如「pubmed-data-fetcher」）。
* （可選）編輯專案 ID（它在 Google Cloud 中必須是唯一的）。
* 選擇一個帳單帳戶（如果您沒有，則需要建立一個）。
* 如果適用，請選擇「位置」（組織/資料夾）。
* 點擊「建立」。
* 啟用 API：

* 導覽至 API 和服務：選擇您的專案後，前往導覽選單（左上角的三條水平線），然後點擊「API 和服務」->「程式庫」。
* 啟用 Google 試算表 API：
* 在 API 程式庫中，搜尋「Google 試算表 API」。
* 點擊「Google 試算表 API」搜尋結果。
* 點擊「啟用」按鈕。
* 啟用 Google Drive API：
* 返回 API 程式庫（使用返回按鈕或導覽選單）。
* 搜尋「Google Drive API」。
* 點擊「Google Drive API」搜尋結果。
* 點擊「啟用」按鈕。
* 建立服務帳戶：

* 導覽至憑證：前往導覽選單 ->「API 和服務」->「憑證」。
* 建立服務帳戶：點擊頁面頂部的「+ 建立憑證」。
* 從下拉式選單中選擇「服務帳戶」。
* 服務帳戶詳細資訊：
* 服務帳戶名稱：輸入您的服務帳戶的名稱（例如 pubmed-fetcher-sa）。
* 服務帳戶 ID：這將根據名稱自動生成，但您可以根據需要進行編輯。
* 服務帳戶說明：（可選）新增說明。
* 點擊「建立並繼續」。
* 授予對專案的存取權限（重要）：在「授予此服務帳戶對專案的存取權限」下，點擊「選擇角色」下拉式選單。
* 對於此專案，您可以選擇專案 -> 編輯者。這將授予您的服務帳戶在專案中的廣泛權限。若要限制存取權限，您可以探索「試算表開發人員」和「雲端硬碟開發人員」等角色，但目前「編輯者」即可。
* 點擊「繼續」。
* 授予使用者對此服務帳戶的存取權限（可選）：對於此使用案例，您可以跳過此步驟。
* 點擊「完成」。
* 建立並下載服務帳戶金鑰：

* 找到您的服務帳戶：在「憑證」頁面上，您現在應該會在「服務帳戶」下方看到您新建立的服務帳戶。
* 前往服務帳戶詳細資訊：點擊服務帳戶名稱（或電子郵件地址）。
* 前往金鑰分頁：點擊「金鑰」分頁。
* 新增金鑰：點擊「新增金鑰」->「建立新的金鑰」。
* 選擇 JSON：選擇「JSON」作為金鑰類型。
* 建立並下載：點擊「建立」。JSON 金鑰文件將下載到您的電腦。安全地儲存此文件 - 它就像您服務帳戶的密碼。
* 重新命名和移動金鑰文件（可選但建議）：

* 將下載的 JSON 文件重新命名為更具描述性的名稱，例如 credentials.json。
* 將 credentials.json 文件移動到 Python 專案的根目錄（或腳本可以存取的其他安全位置）。
* 分享您的 Google 試算表（如果使用現有試算表）：

* 如果您有現有的 Google 試算表要讓腳本存取，您需要與服務帳戶的電子郵件地址分享（您可以在 credentials.json 文件中的 "client_email" 金鑰下找到）。
* 打開您的 Google 試算表，點擊「分享」，將服務帳戶電子郵件新增為「編輯者」，然後點擊「傳送」或「完成」。
* 重要的安全注意事項：
* 不要將您的憑證 JSON 文件提交到公開版本控制儲存庫（例如公開的 GitHub 儲存庫）。將 credentials.json（或您命名的任何名稱）新增到您的 .gitignore 文件中。
* 限制權限：如果可能，請授予您的服務帳戶更精細的權限，而不是「編輯者」，如果您想遵循最小權限原則。
* 環境變數：將您的 API 金鑰和憑證文件的路徑儲存在環境變數中，而不是將它們硬編碼到您的腳本中。
* 完成這些步驟後，您的腳本應該能夠使用服務帳戶憑證進行驗證，並存取必要的 Google API。請務必更新 Python 腳本中的 CREDS_FILE 變數，使其指向您下載的 JSON 金鑰文件的正確路徑。

## 設定 Google 試算表存取權限
要使用此腳本，您需要建立一個 Google 試算表，並與腳本用於驗證的服務帳戶分享。以下是步驟教學：

### 建立 Google 試算表：

* 前往 Google 試算表並建立一個新的空白試算表。
* 為您的試算表提供一個描述性名稱（例如「PubMed 更新」）。您可以選擇性地添加一個標題列，其中包含您希望腳本使用的欄位名稱（例如「pmid」、「title」、「abstract」、「authors」、「journal」、「pubdate」、「abstract_zh_TW」）。
* 取得服務帳戶電子郵件地址：

* 您應該已經建立了一個 Google Cloud 專案和一個服務帳戶，並下載了服務帳戶憑證 JSON 文件（如程式碼的設定說明中所述）。
* 在文字編輯器中打開 JSON 文件。
* 複製此電子郵件地址。

### 分享 Google 試算表：

* 打開您的 Google 試算表。
* 點擊右上角的藍色「分享」按鈕。
* 在「新增人員、群組和日曆活動」欄位中，貼上您在步驟 2 中複製的服務帳戶電子郵件地址。
* 確保選擇了「編輯者」角色（以便腳本可以修改試算表）。
* 點擊「傳送」或「完成」。

* 重要事項：
* [email address removed]」替換為您的服務帳戶憑證文件中的實際電子郵件地址。
* 您只需分享 Google 試算表一次。之後，腳本將能夠使用服務帳戶憑證訪問它。
